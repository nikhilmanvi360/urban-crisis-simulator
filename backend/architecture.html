<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CitySentinel AI — Backend Architecture</title>
    <style>
        /* Simplistic, clean dark theme */
        :root {
            --bg: #09090b;
            /* Very dark slate/zinc */
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --border-light: #27272a;
            --border-dark: #3f3f46;
            --accent: #3b82f6;
            /* Blue accent */
            --bg-card: #18181b;
            --bg-api: #27272a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        h1,
        h2,
        h3,
        h4 {
            font-weight: 600;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: var(--text-main);
        }

        h1 {
            font-size: 2.25rem;
            margin-top: 0;
            margin-bottom: 0.2em;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        p {
            color: var(--text-main);
            margin-bottom: 1rem;
        }

        /* Simple stats */
        .stats {
            display: flex;
            gap: 1.5rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-light);
            margin-bottom: 2rem;
        }

        .stat-box {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            min-width: 120px;
        }

        .stat-num {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-lbl {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Basic Architecture Diagram (List approach for simplicity) */
        .arch-list {
            list-style-type: none;
            padding: 0;
            margin: 0 0 2rem 0;
            border-left: 2px solid var(--border-dark);
        }

        .arch-layer {
            margin-bottom: 1.5rem;
            padding-left: 20px;
            position: relative;
        }

        .arch-layer::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 6px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--accent);
        }

        .arch-layer-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .arch-layer-desc {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* Cards */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--bg);
            border: 1px solid var(--border-dark);
            border-radius: 6px;
            padding: 1.25rem;
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.05rem;
        }

        .card-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0;
        }

        /* API Table */
        .api-list {
            margin-bottom: 2rem;
        }

        .api-item {
            display: flex;
            flex-direction: column;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-light);
        }

        .api-item:last-child {
            border-bottom: none;
        }

        .api-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.25rem;
        }

        .api-method {
            background: var(--bg-card);
            border: 1px solid var(--border-dark);
            font-weight: 600;
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            color: var(--text-main);
        }

        .api-path {
            font-family: monospace;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .api-desc {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        code {
            font-family: monospace;
            background: var(--bg-card);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            border: 1px solid var(--border-light);
            font-size: 0.9em;
        }

        footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-light);
            color: var(--text-muted);
            font-size: 0.85rem;
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>CitySentinel AI</h1>
            <p class="subtitle">Backend Architecture & API Reference</p>
        </header>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-num">6</div>
                <div class="stat-lbl">Engine Modules</div>
            </div>
            <div class="stat-box">
                <div class="stat-num">13</div>
                <div class="stat-lbl">API Endpoints</div>
            </div>
            <div class="stat-box">
                <div class="stat-num">5</div>
                <div class="stat-lbl">City Zones</div>
            </div>
            <div class="stat-box">
                <div class="stat-num">&lt;500ms</div>
                <div class="stat-lbl">Response Time</div>
            </div>
        </div>

        <section>
            <h2>Architecture Layers</h2>
            <p>Clean layered architecture representing the flow of data.</p>

            <ul class="arch-list">
                <li class="arch-layer">
                    <div class="arch-layer-title">Middleware</div>
                    <div class="arch-layer-desc">Helmet Security, Rate Limiter (3-tier), Input Validator, Error Handler,
                        CORS.</div>
                </li>
                <li class="arch-layer">
                    <div class="arch-layer-title">API Layer</div>
                    <div class="arch-layer-desc">Express routing for status, simulate, forecast, recommendations, zones,
                        data, history, and docs.</div>
                </li>
                <li class="arch-layer">
                    <div class="arch-layer-title">Engines</div>
                    <div class="arch-layer-desc">Data Processor, Cascade Engine, Simulation Engine, Forecast Engine,
                        Recommendation Engine, Zone Engine.</div>
                </li>
                <li class="arch-layer">
                    <div class="arch-layer-title">Services</div>
                    <div class="arch-layer-desc">ML Service Client (Adapter pattern), WebSocket Broadcaster.</div>
                </li>
                <li class="arch-layer">
                    <div class="arch-layer-title">Database</div>
                    <div class="arch-layer-desc">MongoDB Atlas providing `environmental_data` and `simulations`
                        collections.</div>
                </li>
            </ul>
        </section>

        <section>
            <h2>Engine Modules</h2>
            <div class="grid">
                <div class="card">
                    <div class="card-title">Data Processor</div>
                    <p class="card-desc">Normalizes raw AQI (0–500), traffic (0–100%), water quality, and emissions to a
                        0–1 risk scale.</p>
                </div>
                <div class="card">
                    <div class="card-title">Cascade Engine</div>
                    <p class="card-desc">Weighted dependency graph computing total risk score, cascade effects, and
                        confidence intervals.</p>
                </div>
                <div class="card">
                    <div class="card-title">Simulation Engine</div>
                    <p class="card-desc">Applies hypothetical policy levers to baseline data and computes before/after
                        risk deltas.</p>
                </div>
                <div class="card">
                    <div class="card-title">Forecast Engine</div>
                    <p class="card-desc">ML Adapter providing 7-day future predictions. Falls back to mock data safely.
                    </p>
                </div>
                <div class="card">
                    <div class="card-title">Recommendation Engine</div>
                    <p class="card-desc">Simulates multiple policy actions and ranks them by cost-weighted efficiency.
                    </p>
                </div>
                <div class="card">
                    <div class="card-title">Zone Engine</div>
                    <p class="card-desc">Computes specific threats and risk levels for 5 distinct city geographical
                        zones.</p>
                </div>
            </div>
        </section>

        <section>
            <h2>City Zones</h2>
            <div class="grid">
                <div class="card">
                    <div class="card-title">Industrial Corridor</div>
                    <p class="card-desc">Primary Threat: Emissions & AQI</p>
                </div>
                <div class="card">
                    <div class="card-title">Residential District</div>
                    <p class="card-desc">Primary Threat: Health & Water</p>
                </div>
                <div class="card">
                    <div class="card-title">Commercial Hub</div>
                    <p class="card-desc">Primary Threat: Traffic & AQI</p>
                </div>
                <div class="card">
                    <div class="card-title">Waterfront Zone</div>
                    <p class="card-desc">Primary Threat: Water (max sensitivity)</p>
                </div>
                <div class="card">
                    <div class="card-title">Transport Gateway</div>
                    <p class="card-desc">Primary Threat: Traffic (max sensitivity)</p>
                </div>
            </div>
        </section>

        <section>
            <h2>API Endpoints</h2>
            <div class="api-list">
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">GET</span>
                        <span class="api-path">/status</span>
                    </div>
                    <div class="api-desc">Current crisis metrics from latest data.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">POST</span>
                        <span class="api-path">/simulate</span>
                    </div>
                    <div class="api-desc">Apply hypothetical policy to get risk delta.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">POST</span>
                        <span class="api-path">/simulate/compare</span>
                    </div>
                    <div class="api-desc">Compare up to 5 scenarios side-by-side.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">GET</span>
                        <span class="api-path">/forecast</span>
                    </div>
                    <div class="api-desc">7-day AQI & water stress forecast.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">GET</span>
                        <span class="api-path">/recommendations</span>
                    </div>
                    <div class="api-desc">Ranked mitigation strategies and policies.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">GET</span>
                        <span class="api-path">/zones</span>
                    </div>
                    <div class="api-desc">Per-zone affected area risk forecasts.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">POST</span>
                        <span class="api-path">/data</span>
                    </div>
                    <div class="api-desc">Real-time data ingestion and WebSocket broadcasting.</div>
                </div>
                <div class="api-item">
                    <div class="api-header">
                        <span class="api-method">GET</span>
                        <span class="api-path">/docs</span>
                    </div>
                    <div class="api-desc">Interactive Swagger UI for full endpoint exploration.</div>
                </div>
            </div>
        </section>

        <section>
            <h2>ML Adapter Pattern</h2>
            <p>
                The backend supports a seamless transition from deterministic mock forecasting to a real ML
                microservice.
                By changing the <code>ML_ENABLED=true</code> flag via environment variable, the forecast engine proxies
                requests to <code>ML_SERVICE_URL</code> using the exact same response schema. If unreachable, it
                gracefully
                falls back to deterministic mocks.
            </p>
        </section>

        <footer>
            CitySentinel AI • Smart Cities & Climate Resilience Hackathon • 2026
        </footer>
    </div>

</body>

</html>